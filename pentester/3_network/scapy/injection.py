#!/usr/bin/python
from scapy.all import *

# Scapy Injection and Forging
# loop=1 -> loop forever / inter=1 is interval in one second
# sendp using layer 2 as well as srp1

sendp(Ether()/IP(dst="google.com")/ICMP()/"XXX", iface="eth1", loop=1, inter=1)

# Send and Receive
# srp1/sr1 is just expecting for one response

srp1(Ether()/IP(dst="google.com", ttl=22)/ICMP()/"XXX")
r1(IP(dst="google.com"), timeout=3)

# Routing (temporarily manipulating routing) -> doesn't change global routing table on the local machine

conf.route.add(host="192.168.11.10", gw="192.168.11.30")
conf.route.resync() # back to original
