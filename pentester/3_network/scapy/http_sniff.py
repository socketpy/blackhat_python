#!/usr/bin/python
from scapy.all import *

def get_HTTPheader(packet):
    try:
        header = packet.load
        if "HTTP/1.1" in header:
            print "[*]", packet[IP].src, "=>", packet[IP].dst
            print header[:header.find('\r\n\r\n')]
            print '\n\n'
    except:
        pass

pkts = sniff(iface="eth1", filter="tcp and port 80", lfilter=lambda p: "HTTP" in str(p),count=30, prn=get_HTTPheader)
