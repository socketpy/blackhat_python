#!/usr/bin/python
from scapy.all import *

pkts = sniff(iface="eth1", filter="icmp", count=3)
#pkts = sniff(iface="eth1", filter="icmp", count=30, prn=lambda x: x.summary())
#pkts = sniff(iface="eth1", filter="icmp", count=30, prn=lambda x: x.show())

#pkts[0].show()
#print "\n"
#hexdump(pkts[0])
#
#print "[*] showing pcap"
#wrpcap("demo.pcap", pkts) #save to pcap
#
#read_pkts = rdpcap("demo.pcap") #read pcap
#
#print read_pkts[0]

#####################
# exporting captured packets as string

icmp_str = str(pkts[0])
print icmp_str

recon = Ether(icmp_str)
print recon

#####################
# export packet as Base64 encoded
encoded = export_object(str(pkts[0]))

#import packet from Base 64
newPkt = import_object(encoded)
