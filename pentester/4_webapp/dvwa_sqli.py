#!/usr/bin/python
"""
SQLi against DVWA for SPSE 4.4 exercise
"""

import mechanize
from bs4 import BeautifulSoup

br = mechanize.Browser()
br.open('http://localhost/dvwa/login.php')
br.select_form(nr=0)
br.form['username'] = 'admin'
br.form['password'] = 'password'
print "[*] Logging into DVWA"
br.submit()
br.follow_link(text="SQL Injection")
print "[*] Visiting SQLi page"

for i in range(10):
    br.select_form(nr=0)
    br.form['id'] = "%s" %(i)
    print "[*] testing User ID field submitting the value %s" %(i)
    br.submit()
    html = br.response().read()
    bs = BeautifulSoup(html, "lxml")
    print bs.findAll('pre')
        


